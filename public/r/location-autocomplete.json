{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "location-autocomplete",
  "title": "Location Autocomplete",
  "description": "Generic location autocomplete component for searching places and addresses. Accepts any provider via the fetchSuggestions prop. Supports client-side or server-side fetches.",
  "dependencies": [
    "use-debounce"
  ],
  "registryDependencies": [
    "command"
  ],
  "files": [
    {
      "path": "src/components/ui/location-autocomplete.tsx",
      "content": "import { cva } from \"class-variance-authority\";\nimport React from \"react\";\nimport { useDebouncedCallback } from \"use-debounce\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\n\nconst commandVariants = cva(\"**:data-[slot=command-input-wrapper]:px-0\", {\n  variants: {\n    variant: {\n      default:\n        \"border-input/30 border-2 px-0 **:data-[slot=input-group]:border-0 bg-popover **:data-[slot=input-group]:bg-popover! **:data-[slot=command-input-wrapper]:border-b\",\n      detached:\n        \"**:data-[slot=command-group]:bg-muted **:data-[slot=command-group]:rounded-lg space-y-2\",\n    },\n  },\n  defaultVariants: {\n    variant: \"default\",\n  },\n});\n\nconst commandItemVariants = cva(\"cursor-pointer\", {\n  variants: {\n    variant: {\n      default: \"bg-popover! hover:bg-muted!\",\n      detached: \"hover:bg-input!\",\n    },\n  },\n  defaultVariants: {\n    variant: \"default\",\n  },\n});\n\n/**\n * Configuration options for a location provider or API service.\n *\n * This interface defines optional settings that can be passed when\n * initializing a provider for `LocationAutocomplete`\n *\n * @property apiKey - Optional API key for the provider.\n *   Required for providers that need authentication (e.g., Google Maps, Mapbox).\n *\n * @property baseUrl - Optional base URL for the API.\n *   Useful if using a custom endpoint or proxy server.\n *\n * Example usage:\n * const config: ProviderConfig = {\n *   apiKey: 'YOUR_API_KEY_HERE',\n *   baseUrl: 'https://api.example.com'\n * }\n */\nexport interface ProviderConfig {\n  apiKey?: string;\n  baseUrl?: string;\n}\n\nexport interface LocationSuggestion<Raw = unknown> {\n  place_id: string;\n  display_name: string;\n  lat: string;\n  lon: string;\n  type: string;\n  importance: number;\n  raw?: Raw;\n}\n\n/**\n * Props for the LocationAutocomplete component.\n *\n * This component is generic and provider-agnostic.\n * Use the `Raw` generic type to type the original backend response if needed.\n *\n * @template Raw - The type of the raw backend response item. Defaults to `unknown`.\n */\ninterface LocationAutocompleteProps<Raw = unknown> {\n  /**\n   * The current value of the input field.\n   * Typically, a string representing what the user has typed.\n   */\n  value: string;\n  /**\n   * Callback fired when the input value changes.\n   * @param value - The updated input string\n   */\n  onQueryChange: (value: string) => void;\n  /**\n   * Function to fetch location suggestions from a backend.\n   * Should return a Promise resolving to an array of `LocationSuggestion<Raw>`.\n   *\n   * @param query - The current input value\n   * @returns A Promise of location suggestions\n   *\n   * Example:\n   *   const results = await fetchSuggestions(query)\n   *   results.map(location => location.display_name)\n   */\n  fetchSuggestions: (query: string) => Promise<LocationSuggestion<Raw>[]>;\n  /**\n   * Callback fired when the user selects a suggestion.\n   *\n   * The `location` object includes a `raw` property containing\n   * the original backend response item.\n   *\n   * @param location - The selected suggestion\n   */\n  onSelect: (location: LocationSuggestion<Raw>) => void;\n  /**\n   * Controls the UX styling of the component.\n   *\n   * - \"default\": The input and results are visually connected; main container has border.\n   * - \"detached\": Results are separated from the input; input container may have border; main container background may differ.\n   */\n  variant?: \"default\" | \"detached\";\n  /**\n   * Debounce delay in milliseconds before calling `fetchSuggestions`.\n   * Defaults to 300ms if not provided.\n   */\n  debounceMs?: number;\n  /**\n   * Optional error handler for fetch failures.\n   * @param error\n   */\n  onError?: (error: Error) => void;\n  /**\n   * Placeholder text for the input field\n   * @default \"Search for a location...\"\n   */\n  placeholder?: string;\n}\n\nfunction LocationAutocomplete<Raw = unknown>({\n  variant = \"default\",\n  value = \"\",\n  onQueryChange,\n  onSelect,\n  fetchSuggestions,\n  debounceMs = 300,\n  onError,\n  placeholder = \"Search for a location...\",\n}: LocationAutocompleteProps<Raw>) {\n  const [items, setItems] = React.useState<LocationSuggestion<Raw>[]>([]);\n  const [open, setOpen] = React.useState(false);\n  const [isLoading, setIsLoading] = React.useState(false);\n\n  const debounced = useDebouncedCallback(async (value) => {\n    try {\n      setIsLoading(true);\n      const results = await fetchSuggestions(value);\n      setItems(results);\n    } catch (error) {\n      onError?.(error as Error);\n    } finally {\n      setIsLoading(false);\n    }\n  }, debounceMs);\n\n  return (\n    <Command shouldFilter={false} className={commandVariants({ variant })}>\n      <CommandInput\n        onValueChange={(value) => {\n          onQueryChange?.(value);\n          setOpen(true);\n          debounced(value);\n        }}\n        value={value}\n        placeholder={placeholder}\n      />\n      {open && (\n        <CommandList>\n          {!isLoading && <CommandEmpty>No results found.</CommandEmpty>}\n          {items.length > 0 && (\n            <CommandGroup>\n              {items.map((item) => (\n                <CommandItem\n                  key={item.place_id}\n                  className={commandItemVariants({ variant })}\n                  onSelect={() => {\n                    onQueryChange?.(item.display_name);\n                    onSelect(item);\n                    setOpen(false);\n                  }}\n                >\n                  {item.display_name || \"Unnamed location\"}\n                </CommandItem>\n              ))}\n            </CommandGroup>\n          )}\n        </CommandList>\n      )}\n    </Command>\n  );\n}\n\nexport { LocationAutocomplete };\nexport type { LocationAutocompleteProps };\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:component"
}