{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "here-provider",
  "title": "HERE Maps Provider",
  "description": "Fetches location suggestions using HERE Geocoding & Search API. Requires a HERE API key. Returns results with address, coordinates, and confidence score.",
  "files": [
    {
      "path": "src/lib/autocomplete/providers/here.ts",
      "content": "import type {\n  LocationSuggestion,\n  ProviderConfig,\n} from \"@/components/ui/location-autocomplete\";\nimport { buildQueryString, fetcher } from \"@/lib/autocomplete/api\";\n\nconst BASE_URL = \"https://autocomplete.search.hereapi.com/v1/autocomplete\";\n\n/**\n * Query options for the HERE Autocomplete API.\n */\nexport interface HereQueryOptions {\n  /**\n   * Specify the center of the search context as coordinates.\n   * Format: {latitude},{longitude}\n   * Example: \"-13.163068,-72.545128\" (Machu Picchu, Peru)\n   */\n  at?: string;\n\n  /**\n   * Restrict search within a geographic area. This is a hard filter.\n   * Only one of `at`, `inCircle`, or `inBbox` can be used.\n   * - Country codes: ISO 3166-1 alpha-3, uppercase\n   * - Circle: \"circle:{lat},{lng};r={radius}\" (radius in meters)\n   * - Bounding box: \"bbox:{west},{south},{east},{north}\"\n   */\n  in?: string;\n\n  /**\n   * Options to return multiple results when a postal code spans multiple areas.\n   * - \"cityLookup\": returns all city combinations for the postal code\n   * - \"districtLookup\": returns all district + city combinations\n   */\n  postalCodeMode?: \"cityLookup\" | \"districtLookup\";\n\n  /**\n   * Limit results to certain types.\n   * Supported values: \"area\", \"city\", \"postalCode\"\n   */\n  types?: Array<\"area\" | \"city\" | \"postalCode\">;\n\n  /**\n   * Preferred languages for the response, as BCP-47 codes.\n   */\n  lang?: string[];\n\n  /**\n   * Maximum number of results to return. Defaults to 5, max 20.\n   */\n  limit?: number;\n\n  /**\n   * Toggle the political view for a specific country.\n   * ISO 3166-1 alpha-3 code in uppercase.\n   * Supported examples: \"ARG\", \"EGY\", \"IND\", \"KEN\", \"MAR\", \"PAK\", \"RUS\", \"SDN\", \"SRB\", \"SUR\", \"SYR\", \"TUR\", \"TZA\", \"URY\", \"VNM\"\n   */\n  politicalView?: string;\n\n  /**\n   * Select additional fields to include in the response.\n   * Supported values:\n   * - \"streetInfo\": renders decomposed street name parts\n   * - \"hasRelatedMPA\": Boolean flag for Micro Point Addresses (houseNumberType: pointAddress)\n   */\n  show?: Array<\"streetInfo\" | \"hasRelatedMPA\">;\n}\n\n// HERE Autocomplete API types\nexport interface HereAutocompleteResponse {\n  items: HereAutocompleteItem[];\n  [k: string]: unknown;\n}\n\nexport type HereResultType =\n  | \"place\"\n  | \"locality\"\n  | \"street\"\n  | \"intersection\"\n  | \"houseNumber\"\n  | \"category\"\n  | \"chain\"\n  | \"query\"\n  | string;\n\nexport type HereHouseNumberType = \"PA\" | \"Interpolated\" | string;\n\nexport interface HereAutocompleteItem {\n  title: string;\n  id: string; // e.g., \"here:af:streetsection:...\"\n  language?: string; // e.g., 'en'\n  resultType: HereResultType; // e.g., 'houseNumber'\n  houseNumberType?: HereHouseNumberType; // e.g., 'PA'\n  address?: HereAddress;\n  highlights?: HereHighlights;\n}\n\nexport interface HereAddress {\n  label?: string;\n  countryCode?: string; // 3-letter, e.g., 'GBR', 'USA'\n  countryName?: string; // e.g., 'United Kingdom'\n  state?: string; // e.g., 'England'\n  stateCode?: string; // e.g., 'NJ'\n  countyCode?: string; // e.g., 'ESX'\n  county?: string; // e.g., 'East Sussex'\n  city?: string; // e.g., 'Eastbourne'\n  district?: string; // e.g., 'Eastbourne'\n  street?: string; // e.g., 'Garden Road'\n  postalCode?: string; // e.g., 'BN20 8HF'\n  houseNumber?: string; // e.g., '44'\n}\n\nexport interface HereHighlights {\n  title?: HereHighlightRange[];\n  address?: HereAddressHighlights;\n}\n\nexport type HereAddressHighlights = Partial<\n  Record<\n    | \"label\"\n    | \"countryName\"\n    | \"state\"\n    | \"county\"\n    | \"city\"\n    | \"district\"\n    | \"street\"\n    | \"postalCode\"\n    | \"houseNumber\",\n    HereHighlightRange[]\n  >\n> & { [k: string]: unknown };\n\nexport interface HereHighlightRange {\n  start: number;\n  end: number;\n}\n\nexport const normalizeHereResult = <T extends HereAutocompleteItem>(\n  item: T,\n): LocationSuggestion<T> => ({\n  place_id: item.id || Math.random().toString(),\n  display_name: item.title || item.address?.label || \"Unknown location\",\n  lat: \"0\",\n  lon: \"0\",\n  type: item.resultType || \"unknown\",\n  importance: 0.5,\n  raw: item,\n});\n\nexport async function fetchHereSuggestions(\n  query: string,\n  config?: ProviderConfig,\n  options?: HereQueryOptions,\n): Promise<LocationSuggestion<HereAutocompleteItem>[]> {\n  const apiKey = config?.apiKey;\n  if (!apiKey) {\n    throw new Error(\"HERE Autocomplete requires an API key in config.apiKey\");\n  }\n\n  const params = buildQueryString({\n    ...(options || {}),\n    q: query,\n    apiKey: config.apiKey,\n    limit: options?.limit || 10,\n    types: options?.types?.join(\",\") || \"\",\n    show: options?.show?.join(\",\") || \"\",\n    lang: options?.lang?.join(\",\") || \"\",\n  });\n\n  const url = `${config?.baseUrl || BASE_URL}?${params}`;\n  const headers: Record<string, string> = {\n    \"Content-Type\": \"application/json\",\n  };\n\n  return fetcher<HereAutocompleteResponse>(url, {\n    headers,\n  }).then(({ response }) => response.items.map(normalizeHereResult));\n}\n",
      "type": "registry:lib"
    },
    {
      "path": "src/lib/autocomplete/api.ts",
      "content": "export interface Response<T> {\n  response: T;\n  status: number;\n}\n\nexport const buildQueryString = (\n  params: Record<\n    string,\n    string | number | boolean | undefined | null | number[]\n  >,\n): string => {\n  return Object.entries(params)\n    .filter(\n      ([_, value]) => value !== undefined && value !== null && value !== \"\",\n    ) // skip empty\n    .map(\n      ([key, value]) =>\n        `${encodeURIComponent(key)}=${encodeURIComponent(String(value))}`,\n    )\n    .join(\"&\");\n};\n\nexport async function fetcher<T>(\n  url: string,\n  options: RequestInit = {},\n): Promise<Response<T>> {\n  const res = await fetch(url, options);\n  const response = await res.json();\n\n  return {\n    response: response as T,\n    status: res.status,\n  };\n}\n",
      "type": "registry:lib"
    }
  ],
  "type": "registry:lib"
}